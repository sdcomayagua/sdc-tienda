<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Tienda Gamer Premium</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Parte 2 (CSS) va aqu√≠ debajo -->
</head>
<body>
  <header class="header">
    <div class="logo-area">
      <div class="logo-mark">RG</div>
      <div class="logo-text">
        <span class="brand">Renee Gaming Store</span>
        <span class="tagline">Setup premium, experiencia pro</span>
      </div>
    </div>
    <nav class="nav">
      <button class="nav-link active">Cat√°logo</button>
      <button class="nav-link">Ofertas</button>
      <button class="nav-link">Servicios</button>
    </nav>
    <div class="header-actions">
      <div class="shipping-pill">
        <span class="dot"></span>
        Env√≠os a todo Honduras
      </div>
      <button id="btnPagar" class="btn-pagar" style="display:none;">
        Ir a pagar (0)
      </button>
    </div>
  </header>

  <main class="layout">
    <section class="filters">
      <h2>Datos de env√≠o</h2>
      <label class="field">
        <span>Departamento</span>
        <select id="departamentoCliente">
          <option value="">Selecciona una opci√≥n</option>
          <option value="Comayagua">Comayagua</option>
          <option value="Francisco Moraz√°n">Francisco Moraz√°n</option>
          <option value="Cort√©s">Cort√©s</option>
          <option value="Yoro">Yoro</option>
          <option value="Atl√°ntida">Atl√°ntida</option>
          <option value="Choluteca">Choluteca</option>
          <option value="El Para√≠so">El Para√≠so</option>
          <option value="Col√≥n">Col√≥n</option>
          <option value="Olancho">Olancho</option>
          <option value="Santa B√°rbara">Santa B√°rbara</option>
          <option value="Valle">Valle</option>
          <option value="Otros">Otros</option>
        </select>
      </label>

      <label class="field">
        <span>Municipio / Ciudad</span>
        <input id="municipioCliente" type="text" placeholder="Ej: Comayagua, Siguatepeque, etc.">
      </label>

      <p class="hint">
        Estos datos se enviar√°n junto con tu pedido por WhatsApp.
      </p>
    </section>

    <section class="catalogo">
      <h2>Productos destacados</h2>
      <div id="productos" class="grid-productos">
        <!-- Productos se cargan din√°micamente -->
      </div>
    </section>
  </main>

  <!-- Parte 3 (JS) va aqu√≠ debajo -->
</body>
</html>

<script>
  const SHEET_CSV_URL =
    "https://docs.google.com/spreadsheets/d/1IG2pHnk7XfZgw4qiyEm_8BuGDNOlJByVv6H_O9PWdrs/export?format=csv";

  const contenedor = document.getElementById("productos");
  const btnPagar = document.getElementById("btnPagar");
  const departamentoCliente = document.getElementById("departamentoCliente");
  const municipioCliente = document.getElementById("municipioCliente");

  let productos = [];
  let carrito = [];

  const bulletsPorCategoria = {
    "gaming": [
      "Eleva tu experiencia al siguiente nivel",
      "Dise√±ado para jugadores exigentes",
      "Rendimiento superior en cada partida",
      "Perfecto para sesiones largas de juego",
      "Construcci√≥n premium para m√°xima durabilidad",
      "Optimizado para precisi√≥n y velocidad",
      "Ideal para juegos competitivos"
    ],
    "accesorios": [
      "Dise√±o pr√°ctico y funcional",
      "Perfecto para uso diario",
      "Materiales de alta calidad",
      "Compatibilidad amplia garantizada",
      "Ideal para mejorar tu setup",
      "Compacto y f√°cil de transportar"
    ],
    "streaming": [
      "Calidad estable y confiable",
      "Ideal para contenido en alta definici√≥n",
      "Acceso r√°pido y sin complicaciones",
      "Perfecto para maratones de series",
      "Optimizado para una experiencia fluida"
    ],
    "audio": [
      "Sonido claro y envolvente",
      "Dise√±ado para comodidad prolongada",
      "Ideal para m√∫sica, juegos y llamadas",
      "Calidad premium en cada detalle"
    ],
    "servicios": [
      "Atenci√≥n r√°pida y personalizada",
      "Proceso seguro y confiable",
      "Ideal para usuarios frecuentes",
      "Optimizado para tu comodidad"
    ],
    "computadoras": [
      "Rendimiento optimizado para multitarea",
      "Componentes de alta calidad",
      "Perfecta para trabajo y entretenimiento",
      "Dise√±ada para durar"
    ]
  };

  function parseCSV(text) {
    const lines = text.trim().split("\n");
    const headers = lines[0].split(",").map(h => h.trim());
    const rows = [];

    for (let i = 1; i < lines.length; i++) {
      if (!lines[i].trim()) continue;
      const cols = lines[i].split(",");
      const obj = {};
      headers.forEach((h, idx) => {
        obj[h] = (cols[idx] || "").trim();
      });
      rows.push(obj);
    }
    return rows;
  }

  function mapRowToProducto(row) {
    const imagenes = [];
    if (row.imagen_1) imagenes.push(row.imagen_1);
    if (row.imagen_2) imagenes.push(row.imagen_2);
    if (row.imagen_3) imagenes.push(row.imagen_3);

    const puntos = [];
    if (row.punto_1) puntos.push(row.punto_1);
    if (row.punto_2) puntos.push(row.punto_2);
    if (row.punto_3) puntos.push(row.punto_3);

    return {
      id: Number(row.id || 0),
      nombre: row.nombre || "",
      categoria: row.categoria || "",
      precio: Number(row.precio || 0),
      precio_oferta: row.precio_oferta ? Number(row.precio_oferta) : null,
      oferta: (row.oferta || "").toLowerCase() === "si",
      stock: Number(row.stock || 0),
      imagenPrincipal: row.imagen_principal || "",
      imagenes,
      video: row.video || "",
      descripcion: row.descripcion || "",
      puntos,
      etiqueta: row.etiqueta || "",
      departamento_envio: row.departamento_envio || "",
      municipio_envio: row.municipio_envio || ""
    };
  }

  function generarPuntosAutomaticos(prod) {
    if (prod.puntos && prod.puntos.length) {
      return prod.puntos;
    }

    const catKey = (prod.categoria || "").toLowerCase();
    const pool = bulletsPorCategoria[catKey] || [
      "Calidad premium en cada detalle",
      "Pensado para una experiencia superior",
      "Ideal para quienes buscan algo mejor"
    ];

    const usados = new Set();
    const result = [];

    while (result.length < 3 && usados.size < pool.length) {
      const idx = Math.floor(Math.random() * pool.length);
      if (!usados.has(idx)) {
        usados.add(idx);
        result.push(pool[idx]);
      }
    }

    return result;
  }

  function renderProductos() {
    contenedor.innerHTML = "";

    productos.forEach((p) => {
      const tieneVideo = p.video && p.video.trim() !== "";
      const tieneMasImagenes = p.imagenes && p.imagenes.length > 0;

      const puntosFinales = generarPuntosAutomaticos(p);
      let bulletsHTML = "";
      if (puntosFinales.length) {
        bulletsHTML = `
          <ul class="bullets">
            ${puntosFinales.map(pt => `<li>${pt}</li>`).join("")}
          </ul>
        `;
      }

      let thumbsHTML = "";
      if (tieneMasImagenes) {
        thumbsHTML = `
          <div class="thumbs" data-product="${p.id}">
            ${p.imagenes.map((img, i) => `
              <div class="thumb ${i === 0 ? "active" : ""}" data-index="${i}">
                <img src="${img}">
              </div>
            `).join("")}
          </div>
        `;
      }

      const tieneOferta = p.oferta && p.precio_oferta && p.precio_oferta < p.precio;

      contenedor.innerHTML += `
        <div class="item" data-id="${p.id}">
          <div class="item-header">
            <h3>${p.nombre}</h3>
            <div class="badge-row">
              ${p.categoria ? `<span class="badge">${p.categoria}</span>` : ""}
              ${p.etiqueta ? `<span class="badge etiqueta">${p.etiqueta}</span>` : ""}
              ${tieneOferta ? `<span class="badge oferta">üî• Oferta</span>` : ""}
            </div>
          </div>

          <div class="price-row">
            <span class="price-main">
              L ${tieneOferta ? p.precio_oferta.toFixed(2) : p.precio.toFixed(2)}
            </span>
            ${tieneOferta ? `<span class="price-old">L ${p.precio.toFixed(2)}</span>` : ""}
          </div>

          <div class="stock">
            Stock: ${p.stock} ¬∑ Env√≠o desde: ${p.departamento_envio || "N/A"}${p.municipio_envio ? " - " + p.municipio_envio : ""}
          </div>

          <div class="media-wrapper" data-media="${p.id}">
            <img src="${p.imagenPrincipal}">
            <div class="media-tag">üñºÔ∏è Imagen principal</div>
          </div>

          ${thumbsHTML}

          <div class="media-actions">
            ${tieneMasImagenes ? `
              <button class="chip-btn" data-action="imagenes" data-id="${p.id}">
                üñºÔ∏è Ver m√°s im√°genes
              </button>
            ` : ""}

            ${tieneVideo ? `
              <button class="chip-btn" data-action="video" data-id="${p.id}">
                üé• Ver video
              </button>
            ` : ""}
          </div>

          ${bulletsHTML}

          <div class="desc-toggle" data-toggle="${p.id}">
            Ver descripci√≥n completa
          </div>

          <div class="desc-full" data-desc="${p.id}">
            ${p.descripcion}
          </div>

          <button class="btn-add" onclick="agregarAlCarrito(${p.id})">
            Agregar al carrito
          </button>
        </div>
      `;
    });

    activarEventos();
  }

  function activarEventos() {
    document.querySelectorAll(".thumbs").forEach(th => {
      th.addEventListener("click", e => {
        const thumb = e.target.closest(".thumb");
        if (!thumb) return;

        const productId = th.getAttribute("data-product");
        const index = parseInt(thumb.getAttribute("data-index"));
        const prod = productos.find(x => x.id == productId);
        const mediaWrapper = document.querySelector(`.media-wrapper[data-media="${productId}"]`);

        mediaWrapper.innerHTML = `
          <img src="${prod.imagenes[index]}">
          <div class="media-tag">üñºÔ∏è Imagen ${index + 1}</div>
        `;

        th.querySelectorAll(".thumb").forEach(t => t.classList.remove("active"));
        thumb.classList.add("active");
      });
    });

    document.querySelectorAll(".chip-btn").forEach(btn => {
      btn.addEventListener("click", () => {
        const action = btn.getAttribute("data-action");
        const id = btn.getAttribute("data-id");
        const prod = productos.find(x => x.id == id);
        const mediaWrapper = document.querySelector(`.media-wrapper[data-media="${id}"]`);

        if (action === "imagenes" && prod.imagenes?.length) {
          mediaWrapper.innerHTML = `
            <img src="${prod.imagenes[0]}">
            <div class="media-tag">üñºÔ∏è Galer√≠a</div>
          `;
        }

        if (action === "video" && prod.video) {
          mediaWrapper.innerHTML = `
            <video controls>
              <source src="${prod.video}" type="video/mp4">
            </video>
            <div class="media-tag">üé• Video</div>
          `;
        }
      });
    });

    document.querySelectorAll(".desc-toggle").forEach(tg => {
      tg.addEventListener("click", () => {
        const id = tg.getAttribute("data-toggle");
        const desc = document.querySelector(`[data-desc="${id}"]`);
        const visible = desc.style.display === "block";

        desc.style.display = visible ? "none" : "block";
        tg.textContent = visible ? "Ver descripci√≥n completa" : "Ocultar descripci√≥n";
      });
    });
  }

  function agregarAlCarrito(id) {
    const prod = productos.find(p => p.id === id);
    if (!prod) return;

    carrito.push(prod);
    btnPagar.style.display = "inline-flex";
    btnPagar.textContent = `Ir a pagar (${carrito.length})`;
  }

  btnPagar.addEventListener("click", () => {
    if (!carrito.length) return;

    const dep = departamentoCliente.value || "No especificado";
    const mun = municipioCliente.value || "No especificado";

    let mensaje = "Hola, quiero comprar:\n\n";
    let total = 0;

    carrito.forEach(c => {
      const precioFinal = (c.oferta && c.precio_oferta && c.precio_oferta < c.precio)
        ? c.precio_oferta
        : c.precio;
      total += precioFinal;
      mensaje += `- ${c.nombre} (L ${precioFinal.toFixed(2)})\n`;
    });

    mensaje += `\nTotal aproximado: L ${total.toFixed(2)}\n`;
    mensaje += `\nDatos de env√≠o:\nDepartamento: ${dep}\nMunicipio/Ciudad: ${mun}\n`;

    const url = "https://wa.me/50400000000?text=" + encodeURIComponent(mensaje);
    window.open(url, "_blank");
  });

  async function cargarProductos() {
    try {
      const res = await fetch(SHEET_CSV_URL);
      const text = await res.text();
      const rows = parseCSV(text);
      productos = rows.map(mapRowToProducto).filter(p => p.id);
      renderProductos();
    } catch (e) {
      console.error("Error cargando productos desde Google Sheets:", e);
      contenedor.innerHTML = "<p>No se pudieron cargar los productos.</p>";
    }
  }

  cargarProductos();
</script>

<style>
  :root {
    --bg-main: #050814;
    --bg-card: #0b1020;
    --bg-card-soft: #101528;
    --accent: #6b5bff;
    --accent-soft: rgba(107, 91, 255, 0.25);
    --accent-strong: #9f7bff;
    --text-main: #f5f5ff;
    --text-soft: #a3a7c7;
    --danger: #ff4b6b;
    --success: #3dd68c;
    --border-subtle: #1b2138;
    --shadow-soft: 0 18px 45px rgba(0, 0, 0, 0.65);
    --radius-lg: 18px;
    --radius-md: 12px;
    --radius-pill: 999px;
  }

  * {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif;
    background: radial-gradient(circle at top, #151a3a 0, #050814 55%, #02030a 100%);
    color: var(--text-main);
    min-height: 100vh;
  }

  .header {
    position: sticky;
    top: 0;
    z-index: 20;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 14px 18px;
    background: linear-gradient(to bottom, rgba(5, 8, 20, 0.96), rgba(5, 8, 20, 0.88));
    border-bottom: 1px solid rgba(255, 255, 255, 0.04);
    backdrop-filter: blur(18px);
  }

  .logo-area {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .logo-mark {
    width: 34px;
    height: 34px;
    border-radius: 12px;
    background: radial-gradient(circle at 30% 0, #ffffff, #9f7bff 40%, #2b2f6b 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 800;
    font-size: 16px;
    color: #050814;
    box-shadow: 0 0 22px rgba(159, 123, 255, 0.7);
  }

  .logo-text {
    display: flex;
    flex-direction: column;
    line-height: 1.1;
  }

  .logo-text .brand {
    font-weight: 600;
    font-size: 14px;
    letter-spacing: 0.03em;
  }

  .logo-text .tagline {
    font-size: 11px;
    color: var(--text-soft);
  }

  .nav {
    display: flex;
    gap: 6px;
  }

  .nav-link {
    border: none;
    background: transparent;
    color: var(--text-soft);
    font-size: 12px;
    padding: 6px 10px;
    border-radius: 999px;
    cursor: pointer;
    transition: 0.2s ease;
  }

  .nav-link.active {
    background: rgba(107, 91, 255, 0.18);
    color: var(--accent-strong);
  }

  .nav-link:hover {
    color: var(--text-main);
  }

  .header-actions {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .shipping-pill {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 10px;
    border-radius: var(--radius-pill);
    background: rgba(16, 21, 40, 0.9);
    border: 1px solid rgba(155, 155, 255, 0.25);
    font-size: 11px;
    color: var(--text-soft);
  }

  .shipping-pill .dot {
    width: 7px;
    height: 7px;
    border-radius: 999px;
    background: var(--success);
    box-shadow: 0 0 10px rgba(61, 214, 140, 0.9);
  }

  .btn-pagar {
    border-radius: var(--radius-pill);
    border: none;
    padding: 8px 14px;
    font-size: 12px;
    font-weight: 600;
    background: linear-gradient(135deg, #6b5bff, #ff4b6b);
    color: #fff;
    cursor: pointer;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.6);
    display: inline-flex;
    align-items: center;
    gap: 6px;
  }

  .btn-pagar:hover {
    filter: brightness(1.05);
  }

  .layout {
    display: grid;
    grid-template-columns: minmax(0, 260px) minmax(0, 1fr);
    gap: 18px;
    padding: 18px;
  }

  .filters {
    background: linear-gradient(145deg, rgba(11, 16, 32, 0.98), rgba(9, 13, 28, 0.98));
    border-radius: var(--radius-lg);
    padding: 16px 14px;
    border: 1px solid var(--border-subtle);
    box-shadow: var(--shadow-soft);
  }

  .filters h2 {
    margin: 0 0 10px;
    font-size: 15px;
  }

  .field {
    display: flex;
    flex-direction: column;
    gap: 4px;
    margin-bottom: 10px;
    font-size: 12px;
  }

  .field span {
    color: var(--text-soft);
  }

  .field select,
  .field input {
    border-radius: 10px;
    border: 1px solid var(--border-subtle);
    background: #050814;
    color: var(--text-main);
    padding: 7px 9px;
    font-size: 12px;
    outline: none;
  }

  .field select:focus,
  .field input:focus {
    border-color: var(--accent-strong);
    box-shadow: 0 0 0 1px rgba(107, 91, 255, 0.4);
  }

  .hint {
    font-size: 11px;
    color: var(--text-soft);
    margin-top: 4px;
  }

  .catalogo {
    background: radial-gradient(circle at top left, rgba(107, 91, 255, 0.18), transparent 55%),
                radial-gradient(circle at bottom right, rgba(255, 75, 107, 0.12), transparent 55%),
                linear-gradient(145deg, rgba(11, 16, 32, 0.98), rgba(9, 13, 28, 0.98));
    border-radius: var(--radius-lg);
    padding: 16px 14px 18px;
    border: 1px solid var(--border-subtle);
    box-shadow: var(--shadow-soft);
  }

  .catalogo h2 {
    margin: 0 0 12px;
    font-size: 16px;
  }

  .grid-productos {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 14px;
  }

  .item {
    background: var(--bg-card);
    border-radius: var(--radius-md);
    padding: 10px;
    border: 1px solid rgba(255, 255, 255, 0.04);
    box-shadow: 0 12px 30px rgba(0, 0, 0, 0.7);
    display: flex;
    flex-direction: column;
    gap: 8px;
    position: relative;
    overflow: hidden;
  }

  .item::before {
    content: "";
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at top, rgba(107, 91, 255, 0.18), transparent 55%);
    opacity: 0.7;
    pointer-events: none;
  }

  .item > * {
    position: relative;
    z-index: 1;
  }

  .item-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 6px;
  }

  .item h3 {
    margin: 0;
    font-size: 14px;
  }

  .badge-row {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    justify-content: flex-end;
  }

  .badge {
    font-size: 10px;
    padding: 3px 7px;
    border-radius: 999px;
    border: 1px solid rgba(255, 255, 255, 0.12);
    background: rgba(5, 8, 20, 0.9);
    color: var(--text-soft);
  }

  .badge.oferta {
    border-color: rgba(255, 75, 107, 0.7);
    color: #ffb3c2;
    background: rgba(255, 75, 107, 0.12);
  }

  .badge.etiqueta {
    border-color: rgba(159, 123, 255, 0.7);
    color: #d5c7ff;
    background: rgba(159, 123, 255, 0.12);
  }

  .price-row {
    display: flex;
    align-items: baseline;
    gap: 6px;
    font-size: 13px;
  }

  .price-main {
    font-weight: 600;
  }

  .price-old {
    font-size: 11px;
    color: var(--text-soft);
    text-decoration: line-through;
  }

  .stock {
    font-size: 11px;
    color: var(--text-soft);
  }

  .media-wrapper {
    position: relative;
    border-radius: 12px;
    overflow: hidden;
    background: #050814;
    border: 1px solid rgba(255, 255, 255, 0.06);
    aspect-ratio: 1 / 1; /* 1080x1080 feeling */
  }

  .media-wrapper img,
  .media-wrapper video {
    width: 100%;
    height: 100%;
    object-fit: cover; /* simula 1080x1080 */
    display: block;
  }

  .media-tag {
    position: absolute;
    left: 8px;
    bottom: 8px;
    padding: 3px 7px;
    border-radius: 999px;
    font-size: 10px;
    background: rgba(5, 8, 20, 0.85);
    border: 1px solid rgba(255, 255, 255, 0.16);
    color: var(--text-soft);
  }

  .thumbs {
    display: flex;
    gap: 6px;
    margin-top: 6px;
  }

  .thumb {
    width: 40px;
    height: 40px;
    border-radius: 10px;
    overflow: hidden;
    border: 1px solid rgba(255, 255, 255, 0.08);
    cursor: pointer;
    opacity: 0.7;
    transition: 0.18s ease;
  }

  .thumb img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .thumb.active {
    opacity: 1;
    border-color: var(--accent-strong);
    box-shadow: 0 0 0 1px rgba(107, 91, 255, 0.6);
  }

  .media-actions {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-top: 4px;
  }

  .chip-btn {
    border-radius: 999px;
    border: 1px solid rgba(255, 255, 255, 0.12);
    background: rgba(5, 8, 20, 0.9);
    color: var(--text-soft);
    font-size: 11px;
    padding: 4px 8px;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: 4px;
  }

  .chip-btn:hover {
    border-color: var(--accent-strong);
    color: var(--accent-strong);
  }

  .bullets {
    margin: 6px 0 0;
    padding-left: 16px;
    font-size: 11px;
    color: var(--text-soft);
  }

  .bullets li {
    margin-bottom: 2px;
  }

  .desc-toggle {
    margin-top: 6px;
    font-size: 11px;
    color: var(--accent-strong);
    cursor: pointer;
  }

  .desc-full {
    display: none;
    margin-top: 4px;
    font-size: 11px;
    color: var(--text-soft);
  }

  .btn-add {
    margin-top: 8px;
    border-radius: 999px;
    border: none;
    padding: 7px 10px;
    font-size: 12px;
    font-weight: 600;
    background: linear-gradient(135deg, #6b5bff, #ff4b6b);
    color: #fff;
    cursor: pointer;
    width: 100%;
  }

  .btn-add:hover {
    filter: brightness(1.05);
  }

  @media (max-width: 840px) {
    .layout {
      grid-template-columns: minmax(0, 1fr);
    }

    .header {
      flex-wrap: wrap;
      gap: 8px;
    }

    .nav {
      order: 3;
      width: 100%;
      justify-content: center;
    }

    .header-actions {
      margin-left: auto;
    }
  }

  @media (max-width: 520px) {
    .header {
      padding: 10px 12px;
    }

    .layout {
      padding: 12px;
    }

    .catalogo {
      padding: 12px 10px 14px;
    }

    .filters {
      padding: 12px 10px;
    }
  }
</style>