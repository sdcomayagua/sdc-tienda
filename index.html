<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Soluciones Digitales Comayagua</title>

<style>
/* ================== VARIABLES ================== */
:root{
  --bg:#0b0f19;
  --card:#111a2e;
  --card2:#0f172a;
  --text:#e7eefc;
  --muted:#9fb2d6;
  --primary:#0b57ff;
  --danger:#ff3b3b;
  --border:rgba(255,255,255,.12);
  --radius:18px;
}
body{
  margin:0;
  font-family:system-ui,Segoe UI,Roboto;
  background:var(--bg);
  color:var(--text);
}

/* ================== TOPBAR ================== */
.topbar{
  position:sticky; top:0; z-index:20;
  display:flex; align-items:center; justify-content:space-between;
  padding:12px;
  background:rgba(0,0,0,.6);
  backdrop-filter:blur(8px);
}
.brand{display:flex; gap:10px; align-items:center; min-width:0;}
.logo{
  width:42px; height:42px; border-radius:14px;
  background:var(--primary);
  display:grid; place-items:center;
  font-weight:900;
}
.brandText{min-width:0}
#storeName{
  font-weight:900;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
#storeSub{font-size:12px; color:var(--muted)}
@media(max-width:720px){
  #storeName{color:transparent; position:relative}
  #storeName::after{
    content:"SDComayagua";
    color:var(--text);
    position:absolute; left:0; top:0;
  }
}

/* ================== CATEGORÍAS ================== */
.chips{
  display:flex; gap:10px;
  overflow:auto; padding:10px;
}
.chip{
  padding:8px 14px;
  border-radius:999px;
  background:var(--card);
  border:1px solid var(--border);
  font-weight:700;
}
.chip.active{background:var(--primary)}

/* ================== GRID ================== */
.grid{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:12px;
  padding:12px;
}
@media(min-width:840px){
  .grid{grid-template-columns:repeat(4,1fr)}
}
.card{
  background:var(--card);
  border-radius:var(--radius);
  overflow:hidden;
  position:relative;
}
.cardImg{
  width:100%; aspect-ratio:1/1;
  object-fit:cover; background:#000;
}
.cardBody{padding:10px}
.cardName{font-weight:800;font-size:13px}
.price{font-weight:900}
.price.offer{color:var(--danger)}
.old{text-decoration:line-through;color:var(--muted);font-size:12px}
.btn{
  margin-top:8px;
  width:100%;
  padding:10px;
  border-radius:12px;
  border:none;
  font-weight:900;
  background:var(--primary);
  color:#fff;
}
.btn[disabled]{background:#555}

/* AGOTADO */
.card.agotado{
  filter:grayscale(1);
}
.card.agotado::after{
  content:"AGOTADO";
  position:absolute; inset:0;
  display:grid; place-items:center;
  font-size:28px; font-weight:900;
  color:rgba(255,0,0,.5);
  background:rgba(0,0,0,.25);
}

/* ================== MODAL ================== */
.backdrop{
  position:fixed; inset:0;
  background:rgba(0,0,0,.6);
  display:none; z-index:50;
}
.modal{
  position:fixed;
  inset:auto 10px 10px 10px;
  max-width:600px; margin:auto;
  background:var(--card);
  border-radius:18px;
  display:none; z-index:60;
}
.modalHeader{
  display:flex; justify-content:space-between;
  padding:12px;
  font-weight:900;
}
.modalBody{padding:12px}
.closeBtn{cursor:pointer}

/* ================== CARRITO ================== */
.cartList{display:flex; flex-direction:column; gap:10px}
.cartItem{
  display:flex; justify-content:space-between; align-items:center;
}
.qty{display:flex; gap:8px; align-items:center}
.qty button{
  width:28px;height:28px;
  border-radius:8px;border:none;
  font-weight:900;
}
.total{margin-top:10px;font-weight:900}

/* ================== WHATSAPP ================== */
.wa{
  position:fixed; right:16px; bottom:16px;
  background:#25D366;color:#fff;
  padding:14px;border-radius:999px;
  font-weight:900;text-decoration:none;
}
</style>
</head>

<body>

<!-- TOP -->
<div class="topbar">
  <div class="brand" onclick="window.scrollTo({top:0,behavior:'smooth'})">
    <div class="logo">SDC</div>
    <div class="brandText">
      <div id="storeName">Soluciones Digitales Comayagua</div>
      <div id="storeSub">Catálogo</div>
    </div>
  </div>
</div>

<!-- CATEGORÍAS -->
<div class="chips" id="chips"></div>

<!-- GRID -->
<div class="grid" id="grid">
  <div style="grid-column:1/-1;text-align:center">
    <b>CARGANDO…</b>
  </div>
</div>

<!-- MODAL -->
<div class="backdrop" id="backdrop" onclick="closeModal()"></div>
<div class="modal" id="modal">
  <div class="modalHeader">
    <span id="mName"></span>
    <span class="closeBtn" onclick="closeModal()">✕</span>
  </div>
  <div class="modalBody">
    <img id="mImg" style="width:100%;border-radius:12px">
    <p id="mDesc"></p>
    <button class="btn" onclick="addToCart()">Agregar al carrito</button>
  </div>
</div>

<!-- WHATSAPP -->
<a class="wa" id="wa" target="_blank">WhatsApp</a>

<script>
/* ================== CONFIG ================== */
const API="https://script.google.com/macros/s/AKfycbytPfD9mq__VO7I2lnpBsqdCIT119ZT0zVyz0eeVjrJVgN_q8FYGgmqY6G66C2m67Pa4g/exec";
let DB=[], CART=[], CURRENT=null;

/* ================== LOAD ================== */
fetch(API).then(r=>r.json()).then(j=>{
  DB=j.productos||[];
  renderCats();
  render(DB);
});

/* ================== RENDER ================== */
function render(list){
  grid.innerHTML="";
  list.forEach(p=>{
    const d=document.createElement("div");
    d.className="card"+(p.stock<=0?" agotado":"");
    d.innerHTML=`
      <img class="cardImg" src="${p.imagen||""}">
      <div class="cardBody">
        <div class="cardName">${p.nombre}</div>
        <div class="price ${p.precio_anterior>p.precio?'offer':''}">
          L ${p.precio}
        </div>
        ${p.precio_anterior>p.precio?`<div class="old">L ${p.precio_anterior}</div>`:""}
        <button class="btn" ${p.stock<=0?"disabled":""} onclick='openModal(${JSON.stringify(p)})'>
          ${p.stock<=0?"Agotado":"Ver detalles"}
        </button>
      </div>`;
    grid.appendChild(d);
  });
}

/* ================== MODAL ================== */
function openModal(p){
  CURRENT=p;
  mName.textContent=p.nombre;
  mImg.src=p.imagen||"";
  mDesc.textContent=p.descripcion||"";
  backdrop.style.display="block";
  modal.style.display="block";
}
function closeModal(){
  backdrop.style.display="none";
  modal.style.display="none";
}

/* ================== CART ================== */
function addToCart(){
  CART.push(CURRENT);
  alert("Agregado al carrito");
  closeModal();
}

/* ================== CATEGORÍAS ================== */
function renderCats(){
  const cats=["Todas",...new Set(DB.map(p=>p.categoria))];
  cats.forEach(c=>{
    const b=document.createElement("button");
    b.className="chip";
    b.textContent=c;
    b.onclick=()=>{
      document.querySelectorAll(".chip").forEach(x=>x.classList.remove("active"));
      b.classList.add("active");
      render(c==="Todas"?DB:DB.filter(p=>p.categoria===c));
    };
    chips.appendChild(b);
  });
}

/* ================== WHATSAPP ================== */
wa.href="https://wa.me/50431517755?text="+encodeURIComponent("Hola, quiero hacer un pedido.");
</script>

</body>
</html>